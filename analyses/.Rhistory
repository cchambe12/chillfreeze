labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
all_mat <- ggplot(me.species, aes(x=mat, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=TRUE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
all_mat
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=TRUE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
all_mat
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur")))))
all_mat
colnames(me.elev)
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=0,1)
all_dist
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist
colnames(me.elev)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1))
all_elev <- ggplot(me.species, aes(x=elev, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Elevation") + ylab("Probability of False Spring") +
guides(fill=FALSE, linetype=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("C.")
all_mat <- ggplot(me.species, aes(x=mst, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Mean Spring Temperature") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("A.")
all_dist <- ggplot(me.species, aes(x=distkm, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("Distance from Coast") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position = "none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("B.")
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0) +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
library(egg)
grid.arrange(all_mat, all_dist, all_elev, all_nao, ncol=2, nrow=2, heights=c(2, 1.5),
widths=c(2, 1.5))
g_legend<-function(a.gplot){
tmp <- ggplot_gtable(ggplot_build(a.gplot))
leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
legend <- tmp$grobs[[leg]]
return(legend)}
mylegend<-g_legend(all_nao)
all_nao <- ggplot(me.species, aes(x=nao, y=.prediction, col=species, linetype=as.factor(cc))) +
stat_smooth(method="lm", span=0.9, se=TRUE, aes(fill=species, linetype=as.factor(cc))) +
theme_classic() +
scale_colour_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
xlab("NAO Index") + ylab("Probability of False Spring") +
guides(fill=FALSE) + scale_linetype_manual(name="Climate Change", values=c("solid", "dotted"),
labels=c("0"="1950-1983",
"1"="1984-2016")) +
theme(legend.key = element_rect(colour = "transparent", fill = "transparent"), legend.text.align = 0, legend.position="none") +
guides(color=guide_legend(override.aes=list(fill=NA))) +
scale_fill_manual(name="Species", values=cols,
labels=c("AESHIP"=expression(paste(italic("Aesculus hippocastanum"))),
"ALNGLU"=expression(paste(italic("Alnus glutinosa"))),
"aaBETPEN"=expression(paste(italic("Betula pendula"))),
"FAGSYL"=expression(paste(italic("Fagus sylvatica"))),
"zFRAEXC"=expression(paste(italic("Fraxinus excelsior"))),
"QUEROB"=expression(paste(italic("Quercus robur"))))) +
coord_cartesian(ylim=c(0,1)) + ggtitle("D.")
quartz()
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=2, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, ncol=3, nrow=2, heights=c(2, 1.5),
layout_matrix=rbind(c(2, 2),
c(1, 1, 1)))
grid.arrange(all_mat, all_dist, all_elev, all_nao, mylegend, heights=c(2, 1.5),
layout_matrix=rbind(c(2, NA, 2),
c(1, 1, 1)))
rm(list=ls())
options(stringsAsFactors = FALSE)
# Load libraries
library(bayesplot) ## for plotting
library(egg) ## for plotting
library(shinystan)
library(rstanarm)
library(rstan)
rstan_options(auto_write = TRUE)
options(mc.cores = parallel::detectCores())
# Set working directory
setwd("~/Documents/git/chillfreeze/analyses")
source('source/stan_utility.R')
chill.stan <- read.csv("output/clean_dvr_60dayoutput.csv", header=TRUE)
chill.stan$ht.diff <- chill.stan$X60dayheight - chill.stan$lo.ht
chill.stan <- chill.stan[!is.na(chill.stan$ht.diff),]
chill.stan$ht.rgr <- (log(chill.stan$X60dayheight) - log(chill.stan$lo.ht)) * 10
datalist.chill <- with(chill.stan,
list(y = ht.diff,
tx = tx,
chill1 = chill1,
chill2 = chill2,
sp = as.numeric(as.factor(species)),
N = nrow(chill.stan),
n_sp = length(unique(chill.stan$species))
)
)
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
anova(ht.diff ~ tx*chill1 + tx*chill2 + (1|species), data=chill.stan)
aov(ht.diff ~ tx*chill1 + tx*chill2 + (1|species), data=chill.stan)
aov(ht.diff ~ tx*chill1 + tx*chill2 + species, data=chill.stan)
mod <- aov(ht.diff ~ tx*chill1 + tx*chill2 + species, data=chill.stan)
summary(mod)
datalist.chill <- with(chill.stan,
list(y = ht.rgr,
tx = tx,
chill1 = chill1,
chill2 = chill2,
sp = as.numeric(as.factor(species)),
N = nrow(chill.stan),
n_sp = length(unique(chill.stan$species))
)
)
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
range(chill.stan$ht.rgr)
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htdiff.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htrgr.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htrgr.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htrgr.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htrgr.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 5000, warmup=1500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
htrgr.inter.normal = stan('stan/zarchive/htrgr_2level_normal.stan', data = datalist.chill,
iter = 5000, warmup=3000, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
chl.inter.normal = stan('stan/zarchive/chl_2level_normal.stan', data = datalist.chill,
iter = 4500, warmup=2500, control=list(max_treedepth = 15,adapt_delta = 0.99)) ###
check_all_diagnostics(htrgr.inter.normal)
y <- as.vector(chill.stan$ht.rgr)
yrep <- rstan::extract(chl.inter.normal)
yrep <- yrep$yhat
ppc <- ppc_stat(y, yrep)
ppc.max <- ppc_stat(y, yrep, stat = "max")
ppc.min <- ppc_stat(y, yrep, stat = "min")
ppc.sd <- ppc_stat(y, yrep, stat = "sd")
#
quartz()
grid.arrange(ppc, ppc.sd, ppc.max, ppc.min, ncol=2, nrow=2)
# Load libraries
library(RColorBrewer)
chill.stan$species.name <- NA
chill.stan$species.name <- ifelse(chill.stan$species=="ACESAC", "Acer saccharinum", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="ALNRUG", "Alnus rugosa", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="BETPAP", "Betula papyrifera", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="BETPOP", "Betula populifolia", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="CORRAC", "Cornus racemosa", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="SALPUR", "Salix purpurea", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="SORAME", "Sorbus americana", chill.stan$species.name)
chill.stan$species.name <- ifelse(chill.stan$species=="VIBDEN", "Viburnum dentatum", chill.stan$species.name)
#chill.stan$species.name <- ifelse(chill.stan$species=="FAGGRA", "Fagus grandifolia", chill.stan$species.name)
#chill.stan$species.name <- ifelse(chill.stan$species=="NYSSYL", "Nyssa sylvatica", chill.stan$species.name)
#### Now for mu plots based of bb_analysis/models_stan_plotting.R ###
figpath <- "figures"
figpathmore <- "ht.rgr" ### change based on model
source("exp_muplot.R")
cols <- adjustcolor("indianred3", alpha.f = 0.3)
my.pal <- rep(brewer.pal(n = 10, name = "Paired"), 8)
xlab <- "Model estimate of change in \nrelative growth rate (height in cm)" ## change based on model
sumer.ni <- summary(chl.inter.normal)$summary
sumer.ni <- summary(htrgr.inter.normal)$summary
sumer.ni[grep("mu_", rownames(sumer.ni)),]
sort(unique(chill.stan$species)) # numbers are alphabetical
modelhere <- htrgr.inter.normal
#quartz()
muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
# display.brewer.all()
alphahere = 0.4
#quartz()
muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
#quartz()
#muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
muplotfx(modelhere, "", 8, 8, c(0,5), c(-0.5, 0.5) , 0.58, 3.5)
#quartz()
#muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
muplotfx(modelhere, "", 8, 8, c(0,5), c(-2, 2) , 2.3, 3.5)
#quartz()
#muplotfx(modelhere, "", 8, 8, c(0,5), c(-10, 10) , 10.5, 3.5)
muplotfx(modelhere, "", 8, 8, c(0,5), c(-1.5, 1.5) , 1.7, 3.5)
